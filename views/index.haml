-# -*- coding: utf-8 -*-
!!!
%html
  %head
    %meta{"http-equiv" => "content-type", :content => "text/html; charset=utf-8"}
    %meta{"http-equiv" => "content-style-type", :content => "text/css"}
    %meta{"http-equiv" => "content-script-type", :content => "text/javascript"}
    %link(rel="stylesheet" href="flexslider.css" type="text/css")
    %script(src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js")
    %script(src="jquery.flexslider.js")
    %title Suberuim
  %body
    %h1 Suberuim

    Powered by
    %a{:href => "http://www.ruby-lang.org/"} Ruby
    ,
    %a{:href => "http://www.sinatrarb.com/intro.html"} Sinatra
    and
    %a{:href => "https://github.com/woothemes/FlexSlider"} FlexSlider

    %div.flexslider
      %ul.slides
        - @paths.each do |path|
          %li
            %a{href: path}
              %img{src: path}
              %p.flex-caption= path

  %a{:href => "https://github.com/myokoym/suberuim"}
    %img{:style => "position: absolute; top: 0; right: 0; border: 0;",
         :src => "https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png",
         :alt => "Fork me on GitHub"}

  :javascript
    (function() {

      // store the slider in a local variable
      var $window = $(window),
          flexslider;

      // tiny helper function to add breakpoints
      function getGridSize() {
        return (window.innerWidth < 600) ? 2 :
               (window.innerWidth < 900) ? 3 : 4;
      }

      $(function() {
        SyntaxHighlighter.all();
      });

      $window.load(function() {
        $('.flexslider').flexslider({
          animation: "slide",
          animationLoop: false,
          itemWidth: 210,
          itemMargin: 5,
          minItems: getGridSize(), // use function to pull in initial value
          maxItems: getGridSize() // use function to pull in initial value
        });
      });

      // check grid size on resize event
      $window.resize(function() {
        var gridSize = getGridSize();

        flexslider.vars.minItems = gridSize;
        flexslider.vars.maxItems = gridSize;
      });
    }());
